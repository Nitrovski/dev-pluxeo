"use strict";
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __reExport = (target, mod, secondTarget) => (__copyProps(target, mod, "default"), secondTarget && __copyProps(secondTarget, mod, "default"));
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/webhooks.ts
var webhooks_exports = {};
__export(webhooks_exports, {
  verifyWebhook: () => verifyWebhook
});
module.exports = __toCommonJS(webhooks_exports);
var import_webhooks = require("@clerk/backend/webhooks");

// src/utils.ts
var fastifyRequestToRequest = (req) => {
  const headers = new Headers(
    Object.keys(req.headers).reduce((acc, key) => {
      const value = req.headers[key];
      if (!value) {
        return acc;
      }
      if (typeof value === "string") {
        acc.set(key, value);
      } else {
        acc.set(key, value.join(","));
      }
      return acc;
    }, new Headers())
  );
  const dummyOriginReqUrl = new URL(req.url || "", `${req.protocol}://clerk-dummy`);
  return new Request(dummyOriginReqUrl, {
    method: req.method,
    headers
  });
};

// src/webhooks.ts
__reExport(webhooks_exports, require("@clerk/backend/webhooks"), module.exports);
async function verifyWebhook(req, options) {
  const webRequest = fastifyRequestToRequest(req);
  const clonedRequest = new Request(webRequest, {
    body: JSON.stringify(req.body)
  });
  return (0, import_webhooks.verifyWebhook)(clonedRequest, options);
}
// Annotate the CommonJS export names for ESM import in node:
0 && (module.exports = {
  verifyWebhook,
  ...require("@clerk/backend/webhooks")
});
//# sourceMappingURL=webhooks.js.map